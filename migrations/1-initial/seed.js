let titles = [
    'Ninja-Turtles B-Day Party',
    'Bowling for Dollars',
    'Pizza BRUNCH',
    'NANANANANANANANA BATMAN!',
    'Easy Cheese Enthusiasts Annual Meeting',
    'Blue Jeans and Tricycles',
    'Eye Drop Addicts Anonymous',
    'Robot Hand Users Workshop',
    'Fortune Cookie Fortune Creator\'s Weekly Brainstorming Session',
    'Night Sky Abolitionists',
];
let snippets = [
    'Break out your sweatpants, it\'s time for another one!',
    'Easy does it, this time...',
    'How far will you tumble?',
    'Jesus didn\'t care about that either.',
    'Socks!? NOT TODAY!',
    'This will totally fit in my mouth.',
    'Slather it on real well',
    'The redness and itching means it\'s working!',
    'Suckers, one and all',
    'Once again we present...',
]
let descs = [
    `But what I will not do is suggest that the Senator takes his positions for political purposes. I have made it clear to the Iraqi people that we pursue no bases, and no claim on their territory or resources.

It's that we all have it within our power to make this a better world. Now is the time to finally keep the promise of affordable, accessible health care for every single American. Words alone cannot meet the needs of our people. Make no mistake: we do not want to keep our troops in Afghanistan. And despite the costs involved, America's commitment will not weaken. Americans are ready to join with citizens and governments; community organizations, religious leaders, and businesses in Muslim communities around the world to help our people pursue a better life.

They want a sense of purpose, a narrative arc to their lives. The same is true for the astonishing progress within Muslim-majority countries from Kuala Lumpur to Dubai.

But race is an issue that I believe this nation cannot afford to ignore right now. Trade can bring new wealth and opportunities, but also huge disruptions and changing communities.

I am grateful to finish this journey with one of the finest statesmen of our time, a man at ease with everyone from world leaders to the conductors on the Amtrak train he still takes home every night. Not with so many families to protect and so many lives to mend. `,
    `Did I strongly disagree with many of his political views? Absolutely - just as I'm sure many of you have heard remarks from your pastors, priests, or rabbis with which you strongly disagreed. You have shown what history teaches us - that at defining moments like this one, the change we need doesn't come from Washington.

A belief that there are better days ahead. But the truth is, that isn't all that I know of the man. We measure progress by how many people can find a job that pays the mortgage; whether you can put a little extra money away at the end of each month so you can someday watch your child receive her college diploma. America will align our policies with those who pursue peace, and say in public what we say in private to Israelis and Palestinians and Arabs. This is not simply about America's interests. There need not be contradiction between development and tradition.`,
    `People are coming together around a simple truth - that we are all connected, that I am my brother's keeper; I am my sister's keeper. That's not simply a matter of policy or ideology - it's a moral commitment. That commitment is at the core of the Treaty, and it must be kept for all who fully abide by it. And fault lines must be closed among Muslims as well, as the divisions between Sunni and Shia have led to tragic violence, particularly in Iraq. `,
    `That anger may not get expressed in public, in front of white co-workers or white friends. That is one option. In signing the Treaty of Tripoli in 1796, our second President John Adams wrote, "The United States has in itself no character of enmity against the laws, religion or tranquility of Muslims." And since our founding, American Muslims have enriched the United States. Around the world, we can turn dialogue into Interfaith service, so bridges between peoples lead to action - whether it is combating malaria in Africa, or providing relief after a natural disaster.

In the face of that young student who sleeps just three hours before working the night shift, I think about my mom, who raised my sister and me on her own while she worked and earned her degree; who once turned to food stamps but was still able to send us to the best schools in the country with the help of student loans and scholarships. But that same principle must apply to Muslim perceptions of America. This issue has been a source of tension between the United States and the Islamic Republic of Iran. That does not lessen my commitment, however, to governments that reflect the will of the people.

Farmers and scholars; statesmen and patriots who had traveled across an ocean to escape tyranny and persecution finally made real their declaration of independence at a Philadelphia convention that lasted through the spring of 1787. On November 4th, we must stand up and say: "Eight is enough." All of us share this world for but a brief moment in time.

Our Party has chosen a man to lead us who embodies the best this country has to offer. And it means taking full responsibility for own lives - by demanding more from our fathers, and spending more time with our children, and reading to them, and teaching them that while they may face challenges and discrimination in their own lives, they must never succumb to despair or cynicism; they must always believe that they can write their own destiny. And as so many generations have come to realize over the course of the two-hundred and twenty one years since a band of patriots signed that document in Philadelphia, that is where the perfection begins.

You know, a while back, I met a young man named Shamus [Seamus?] in a V.F.W. For alongside our famous individualism, there's another ingredient in the American saga. But we shouldn't use our humility as an excuse for inaction. And you know what - it's worked before. Many more are simply skeptical that real change can occur.

And for the sake of our economy, our security, and the future of our planet, I will set a clear goal as President: in ten years, we will finally end our dependence on oil from the Middle East. But if we see this conflict only from one side or the other, then we will be blind to the truth: the only resolution is for the aspirations of both sides to be met through two states, where Israelis and Palestinians each live in peace and security.

That we can say what we think, write what we think, without hearing a sudden knock on the door. But my journey is part of a larger journey - one shared by all who've ever sought to apply the values of their faith to our society. I was raised with the help of a white grandfather who survived a Depression to serve in Patton's Army during World War II and a white grandmother who worked on a bomber assembly line at Fort Leavenworth while he was overseas. Now is the time to change our bankruptcy laws, so that your pensions are protected ahead of CEO bonuses; and the time to protect Social Security for future generations. But if we see this conflict only from one side or the other, then we will be blind to the truth: the only resolution is for the aspirations of both sides to be met through two states, where Israelis and Palestinians each live in peace and security. That is why I strongly reaffirmed America's commitment to seek a world in which no nations hold nuclear weapons.

People don't expect government to solve all their problems. It's what allows us to pursue our individual dreams and yet still come together as one American family. Without these ingredients, elections alone do not make true democracy. And I will host a Summit on Entrepreneurship this year to identify how we can deepen ties between business leaders, foundations and social entrepreneurs in the United States and Muslim communities around the world.

For some, nagging questions remain. The Republican nominee, John McCain, has worn the uniform of our country with bravery and distinction, and for that we owe him our gratitude and respect. I don't know what kind of lives John McCain thinks that celebrities lead, but this has been mine. That promise is our greatest inheritance. Words alone cannot meet the needs of our people. Without these ingredients, elections alone do not make true democracy.

This is a problem that's brought together churches and synagogues and mosques and people of all faiths as part of a grassroots movement. It's not consistent with our traditions of justice and fairness. This is the reality in which Reverend Wright and other African-Americans of his generation grew up. Washington's been talking about our oil addiction for the last thirty years, and John McCain has been there for twenty-six of them. I'll invest in early childhood education. `,
    `The press has scoured every exit poll for the latest evidence of racial polarization, not just in terms of white and black, but black and brown as well. What is that promise?

Did I strongly disagree with many of his political views? Absolutely - just as I'm sure many of you have heard remarks from your pastors, priests, or rabbis with which you strongly disagreed. And because she had to miss days of work, she was let go and lost her health care. I am a Christian, but my father came from a Kenyan family that includes generations of Muslims. Tomorrow, I will visit Buchenwald, which was part of a network of camps where Jews were enslaved, tortured, shot and gassed to death by the Third Reich. Rather than remain trapped in the past, I have made it clear to Iran's leaders and people that my country is prepared to move forward. That does not lessen my commitment, however, to governments that reflect the will of the people.

The fourth issue that I will address is democracy. That is the world we seek.

Born into poverty? Pull yourself up by your own bootstraps - even if you don't have boots. But privately, many Muslims recognize that Israel will not go away. `,
    `It was stained by this nation's original sin of slavery, a question that divided the colonies and brought the convention to a stalemate until the founders chose to allow the slave trade to continue for at least twenty more years, and to leave any final resolution to future generations. Why else would he define middle-class as someone making under five million dollars a year? How else could he propose hundreds of billions in tax breaks for big corporations and oil companies but not one penny of tax relief to more than one hundred million Americans? How else could he offer a health care plan that would actually tax people's benefits, or an education plan that would do nothing to help families pay for college, or a plan that would privatize Social Security and gamble your retirement? `,
    `In that time, I've had the chance to talk with Americans all across this country. Their experience is the immigrant experience - as far as they're concerned, no one's handed them anything, they've built it from scratch. `,
    `We worship an awesome God in the Blue States, and we don't like federal agents poking around in our libraries in the Red States. Those stories - of survival, and freedom, and hope - became our story, my story; the blood that had spilled was our blood, the tears our tears; until this black church, on this bright day, seemed once more a vessel carrying the story of a people into future generations and into a larger world. It is based upon cultural and historical ties, and the recognition that the aspiration for a Jewish homeland is rooted in a tragic history that cannot be denied. Israel must also live up to its obligations to ensure that Palestinians can live, and work, and develop their society. `,
    `But my journey is part of a larger journey - one shared by all who've ever sought to apply the values of their faith to our society. It's an idea that's often forgotten or dismissed in cynical times. We're not going to agree on everything, but we can disagree without being disagreeable. This truth transcends nations and peoples - a belief that isn't new; that isn't black or white or brown; that isn't Christian, or Muslim or Jew. Now, that must be our work here on Earth.`,
    `And nothing will change. He said that our economy has made "great progress" under this President. For more than sixty years they have endured the pain of dislocation. `,
]

let locationNames = [
    'The Spot',
    'Erryone\'s Fave',
    'Morris Day and the Time',
    'The Apolo',
    'The Lion\'s den',
    'The Hermit Crab Shell',
    'Clean Plate Club HQ',
    'Meatorium',
    'Very Old Structure',
    'The Metrodome 2',
];
let locationDescs = [
    'Take I94 from Detroit to Seattle then turn right at the Wendy\'s, it\'ll be on your left... you can\'t miss it',
    'Dig a tunnel in your back yard for the next 2 hours, if you can still exit then dig for another 2 hours, punch the south wall 50 times with your right hand following the rhythm of Bon Jovi\'s livin\' on a prayer. After that it should be pretty apparent where we are. ',
    'Exit the information super highway onto main street, take the first 3 rights you see. We will be on your left with the big neon analog clock in the window.',
    'Ride your bike for 1 hour turning the pedals one rotation ever 60 seconds, no faster, no slower. The entrance will be in the ground next to the 100 year old weeping willow. Make sure to use the door with the large lion head knocker (the one with a gargoyle head knocker is not us!).',
    'Walk backwards through each door of your house, ending with the front door. Turn around and hop 5 times moving down any stairs that may be present. You will feel a slight pulling sensation in the right ear, at that point you should see our building on your left. Head through the manhole cover in the street out front.',
    'Imagine you were born in an era of famine for your people. In this dream, you must find the legendary hazelnut cache placed into hiding by the worlds greatest villain. Once you find that we are right next door, see you soon!',
    'Take county road 2 up t\'wards Gene\'s house, ease off the road right after you pass the sycamore tree that is next to a barrel of oats. The path should be mostly clear, be sure to avoid any scarecrows that have been erected since our last extermination. After about 1 mile off the road make a right at the peat bog. Once your car is fully submerged someone will be by shortly to get you.',
    'From sunup to sundown make sure to poke the know it your largest tree once an hour, at the top of the hour. At the bottom of each hour, run exactly 1 gallon of water from the tap that is highest in your house (we recommend using a 1 gallon pitcher with a clearly marked line for measurement). Collect all of your water and dump in on the roots of a near by dandelion once the sun has gone down. Go to sleep with your socks on and in the morning you will arrive around sunup.',
    'Listen to Bruce Springsteen\'s and Manfred Man\'s version of Blinded by the Light each 5 times, alternating. Once complete write down the first word that pops into your head on a yellow post-it note. Eat the post-it note. Get in your car and drive one mile in any direction, turning only when the you cannot go forward. park your car there and walk to the nearest strip mall, were are the last shop on the left hand side.',
    'Grab your favorite book off the shelf and turn it to a random page. If the page is below 100, grab another book at try again, repeat until you have a page greater than 100. Memorize the first word that is longer than 8 character while also not being a proper noun. Whisper this into the ear of the closest dog. The dog should run and grab your shoes, put them on. Walk in the direction that feels the most correct until you no longer have the urge. At that point you should be right outside our door.',
]
let users = require('./guests.js');

function getUsers(number) {
    let g = users.map((n, i) => new Guest(i, n));
    if (!number) return g;
    while (g.length > number) {
        g.popRnd();
    }
    return g;
}

let things = [
    'yarn',
    'mustard',
    'foil',
    'grass',
    'meal wurm',
    'weapon',
    '+1',
    'drug',
    'spice',
    'hair'
]

function generateSeedScript() {
    let parties = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9].map((n, i) => new Party(i));
    return [`INSERT INTO party
(name, date, description, snippet, image_path, rsvp_item)
VALUES ${parties.map(p => p.toSql()).join(',\n')};`,
    `INSERT INTO guest
(name, email)
VALUES ${getUsers().map(g => g.toSql()).join(',\n')};`,
    `INSERT INTO place
(name, description, party_id)
VALUES ${parties.map(p => p.place.toSql()).join(',\n')};`,
    `INSERT INTO invite
(guest_id, party_id)
VALUES ${parties.reduce((prev, p) => {
    prev.push(...p.invites);
    return prev;
},[]).map(i => i.toSql())
        .join(',\n')};`,]
    .join('\n\n');
}

function Party(i) {
    this.id = i + 1;
    this.name = sqlStr(titles.popRnd());
    this.date = sqlStr(randomDate());
    this.desc = sqlStr(descs.popRnd());
    this.snip = sqlStr(snippets.popRnd());
    this.image_path = sqlStr(`img/${i}.png`);
    if (Math.random() > 0.8) {
        this.bringing = 'NULL';
    } else {
        this.bringing = sqlStr(things.popRnd());
    }
    this.place = new Place(this.id);
    let users = getUsers(Math.floor(Math.random() *10) + 1)
    this.invites = users.map(u => new Invite(u.id, this.id));
}

Party.prototype.toSql = function() {
    return `(${this.name}, ${this.date}, ${this.desc}, ${this.snip}, ${this.image_path}, ${this.bringing})`
}

function Guest(i, name) {
    this.id = i + 1;
    this.name = name;
    this.email = `${name.toLowerCase().replace(/\s/g, '.')}@example.com`;
}

Guest.prototype.toSql = function() {
    return `(${sqlStr(this.name)}, ${sqlStr(this.email)})`;
}

function Invite(userId, partyId) {
    this.userId = userId;
    this.partyId = partyId;
}
Invite.prototype.toSql = function() {
    return `(${this.userId}, ${this.partyId})`;
}
function Place(partyId) {
    this.name = locationNames.popRnd();
    this.desc = locationDescs.popRnd();
    this.partyId = partyId;
}
Place.prototype.toSql = function() {
    return `(${sqlStr(this.name)}, ${sqlStr(this.desc)}, ${this.partyId})`;
}

function sqlStr(s) {
    if (!s) return 'NULL';
    return `'${s.replace(/'/g, "''")}'`;
}

Array.prototype.popRnd = function() {
    let idx = Math.floor(Math.random() * this.length);
    return this.splice(idx, 1)[0]
}

function randomDate() {
    let d = new Date();
    let newMonth = d.getMonth() + randomInt(-10, 10);
    let newDay = d.getDate() + randomInt(-15, 15);
    let newYear = d.getFullYear() + randomInt(-5, 5);
    let newHour = randomInt(12, 18);
    return new Date(newYear, newMonth, newDay, newHour, 0, 0, 0).toISOString();
}

function randomInt(min, max) {
    if (!min) min = 0;
    if (!max) max = 10;
    return Math.floor(Math.random() * (max - min)) + min;
}

console.log(generateSeedScript());